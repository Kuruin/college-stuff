Build a full-stack web application called:

"Secure Cloud-Based Event Media Management System"

==================================================
STRICT SECURITY REQUIREMENTS
==================================================

1. This is a PRIVATE application.
2. No public access to events, media, or users.
3. All pages and APIs must require authentication middleware.
4. When a user clicks Logout:
   - Destroy server session or invalidate JWT.
   - Clear authentication cookies/tokens.
   - Redirect immediately to Login page.
   - Disable caching of protected pages.
   - Prevent access to protected pages using browser back button.
   - Any attempt to access protected routes after logout must redirect to Login page.
5. Return proper status codes:
   - 401 Unauthorized
   - 403 Forbidden

==================================================
LOGIN FLOW CONTROL (IMPORTANT – FIX NEW USER LOGIN ISSUE)
==================================================

When a user attempts to login:

Step 1: Check if email exists.
   - If not → Show "Invalid email or password."

Step 2: Compare password using bcrypt.
   - If incorrect → Show "Invalid email or password."

Step 3: If credentials are correct:
   - Check if user.approved == true

      IF approved == false:
         - Do NOT create session or JWT.
         - Do NOT redirect to dashboard.
         - Show message:
           "Your account is pending admin approval."

      IF approved == true:
         - Create session or generate JWT.
         - Redirect to dashboard.

Important:
- Never show raw system/database errors.
- Never create login session for unapproved users.
- Handle login gracefully without crashing.

==================================================
ADMIN HIERARCHY SYSTEM (ROLE-BASED PRIORITY)
==================================================

There must be three roles:

- Super Admin (Highest Authority)
- Co-Admin (Secondary Admin)
- User (Normal User)

--------------------------------------------------
SUPER ADMIN (Permanent & Highest Priority)
--------------------------------------------------

1. There must be ONLY ONE Super Admin.
2. Store Super Admin credentials in environment variables:
   - SUPER_ADMIN_EMAIL
   - SUPER_ADMIN_PASSWORD
3. On server startup:
   - Check if Super Admin exists.
   - If not, automatically create it using env credentials.
4. Super Admin cannot be deleted.
5. Super Admin cannot be demoted.
6. Users cannot register as Super Admin.

Super Admin can:
- Approve or block users
- Promote a user to Co-Admin
- Demote Co-Admin to User
- Create, update, delete events
- Upload and delete event media
- Send system-wide announcements
- View system activity

--------------------------------------------------
CO-ADMIN (Delegated Authority)
--------------------------------------------------

Co-Admin can:
- Approve or block normal users
- Create and manage events
- Upload media to events
- Send event-related announcements

Co-Admin CANNOT:
- Modify or delete Super Admin
- Promote anyone to Super Admin
- Modify role hierarchy
- Delete Super Admin
- Remove another Co-Admin without Super Admin approval

--------------------------------------------------
USER (Normal User)
--------------------------------------------------

1. Users can register normally.
2. Default registration values:
   - role = "user"
   - approved = false
3. Only Super Admin or Co-Admin can approve users.
4. If not approved:
   - Show: "Access Denied – Awaiting Admin Approval"

==================================================
ROLE SECURITY RULES
==================================================

1. Role field must never be editable via public API.
2. Role changes must happen only through protected admin routes.
3. Enforce hierarchy:
   Super Admin > Co-Admin > User
4. Use middleware to validate role before sensitive actions.
5. Return 403 Forbidden for unauthorized role attempts.

==================================================
FUNCTIONAL REQUIREMENTS
==================================================

ADMIN FEATURES:
- Manage users
- Approve/block users
- Create upcoming events
- Edit event details
- Delete events
- Upload photos/videos to specific events
- Delete event media

--------------------------------------------------
AUTHORIZED USER FEATURES
--------------------------------------------------

- Login only after approval
- View list of upcoming events
- Click event → Open dedicated Event Gallery page
- See ONLY photos/videos related to that event
- Upload media to selected event (if allowed)

==================================================
EVENT-WISE MEDIA ORGANIZATION
==================================================

1. Media must be linked using eventId.
2. Each event must have its own gallery page.
3. No mixing of media between events.
4. Navigation flow:
   Event List → Event Details → Event Gallery

==================================================
PHOTO INTERACTION SYSTEM (CLEARLY DEFINED)
==================================================

Each photo inside the Event Gallery must include:

1. View Button:
   - Opens full-screen preview modal or dedicated preview page.
   - User can clearly see the image/video in large format.

2. Download Button:
   - Direct secure download option for the file.

3. React Button:
   - Like button or emoji reaction option.
   - Store reaction in database.
   - Display total reaction count below the photo.

Reaction database must store:
- mediaId
- userId
- reactionType

(Optional: Prevent duplicate reactions from same user.)

==================================================
UNAUTHORIZED ACCESS RULES
==================================================

- If not logged in → Redirect to Login page.
- If logged in but not approved → Show access denied message.
- If non-admin accesses admin route → 403 Forbidden.
- After logout → Any protected route must redirect to Login page.
- Disable caching of authenticated pages.

==================================================
TECH STACK
==================================================

Frontend:
- HTML, CSS, JavaScript

Backend:
- Node.js with Express

Database (DBaaS):
- MongoDB Atlas

Storage as a Service:
- Firebase Storage or cloud object storage

Security as a Service:
- Authentication
- Role-Based Access Control (RBAC)
- Password hashing (bcrypt)
- Secure session/JWT handling
- Environment variables
- HTTPS

Hosting (PaaS):
- Deploy on public cloud hosting platform

Infrastructure (IaaS):
- Application runs on cloud virtual machines/infrastructure

==================================================
DATABASE MODELS
==================================================

User:
- name
- email
- password (hashed)
- role (super-admin / co-admin / user)
- approved (true/false)

Event:
- title
- description
- date

Media:
- eventId (reference to Event)
- fileUrl
- uploadedBy

Reaction:
- mediaId
- userId
- reactionType

==================================================
PROJECT STRUCTURE
==================================================

- /public
- /routes
- /models
- /controllers
- /middleware
- server.js

==================================================
NON-FUNCTIONAL REQUIREMENTS
==================================================

- Clean responsive UI
- Proper input validation
- Error handling
- Secure API design
- Use environment variables for secrets
- Add comments explaining:
   IaaS
   PaaS
   DBaaS
   Storage as a Service
   Security as a Service

==================================================
OUTPUT REQUIREMENTS
==================================================

- Generate complete runnable project code.
- Provide environment variable setup instructions.
- Provide MongoDB connection steps.
- Ensure logout redirects to login page.
- Ensure back-button protection works.
- Ensure strict role hierarchy is enforced.
- Ensure login flow handles unapproved users properly.
